# 2026-02-13 (금)

## 📈 주식 시스템 수정

### 삼성물산 딥바이 리스트 버그
- 낙폭매수로 삼성물산(028260) 매수됐으나 딥바이 리스트에 자동 추가 안 됨
- **원인**: 백엔드 재시작 시점 문제 또는 DB 추가 실패
- **해결**: 수동으로 DB에 추가 후 백엔드 재시작

### 삼성전자/삼성전자우 최소 1주 보유
- **요청**: 삼성전자, 삼성전자우는 최소 1주 보유
- **수정 파일들**:
  1. `simple_deep_buy.py` - SAMSUNG_MIN_HOLD_QTY = 1
  2. `samsung_deep_buy_service.py` - MIN_HOLD_QTY = 1
  3. `_sell_one_share_on_peak()` - 신고점 매도에서도 최소 보유 체크
- **커밋**: 3개 (ac7e50f, 558c63a, 1624e8e)

### 낙폭매수 스캔 시간 변경
- 이전: 09:00 ~ 15:00
- 변경: **12:00 ~ 15:00**
- 동반매수 전략은 비활성화 상태 (낙폭매수로 대체됨)

---

## 💬 카카오톡 실시간 모니터링 시스템

### 시도한 방법들
1. **Wine 카톡 DB** → 암호화됨 ❌
2. **Mac 카톡 DB** → 암호화됨 ❌
3. **macOS 알림 로그** → ✅ 성공!

### Mac 알림 로그로 카톡 감지
```bash
log stream --predicate 'process == "NotificationCenter" AND eventMessage CONTAINS "com.kakao.KakaoTalkMac"' --style compact
```
- 카톡 알림 올 때 로그 감지 가능
- 메시지 내용은 `<private>`로 마스킹됨 (프라이버시)

### 만든 스크립트들 (Mac: 192.168.0.18)
- `~/scripts/katok-monitor.sh` - 알림 감지 데몬
- `~/scripts/katok-export-auto.sh` - 자동 대화 내보내기 + diff
- `~/Library/LaunchAgents/com.ppak.katok-monitor.plist` - 서비스 등록

### 현재 상태
- 알림 감지: ✅ 성공
- 자동 내보내기: ❌ 저장 실패 (AppleScript 타이밍 문제)
- **다음**: 저장 대화상자 자동화 디버깅 필요

### 동작 구조
```
카톡 알림 감지 (log stream)
    ↓
자동 대화 내보내기 (Cmd+S)
    ↓
이전 파일과 diff
    ↓
새 메시지만 추출
```

---

## 📝 기타
- Mac 손쉬운 사용에 터미널 추가 필요 (AppleScript 권한)
- 아이폰이라 폰 연동은 어려움
